{
  "name": "@mocks-server/cypress-commands",
  "version": "6.1.1",
  "description": "Extends Cypress' cy commands with methods for administrating Mocks Server",
  "keywords": [
    "cypress",
    "commands",
    "plugin",
    "mocks-server",
    "mock",
    "server",
    "administration",
    "admin",
    "api",
    "rest",
    "client"
  ],
  "author": "Javier Brea",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/mocks-server/main.git",
    "directory": "packages/cypress-commands"
  },
  "homepage": "https://www.mocks-server.org",
  "publishConfig": {
    "access": "public"
  },
  "files": [
    "dist"
  ],
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "dependencies": {
    "@mocks-server/admin-api-paths": "5.0.0",
    "@mocks-server/admin-api-client": "7.0.0"
  },
  "peerDependencies": {
    "cypress": ">=2.0.0"
  },
  "engines": {
    "node": ">=14.0.0"
  },
  "scripts": {
    "build": "tsc",
    "test:unit": "jest"
  },
  "readme": "<p align=\"center\"><a href=\"https://mocks-server.org\" target=\"_blank\" rel=\"noopener noreferrer\"><img width=\"120\" src=\"https://www.mocks-server.org/img/logo_120.png\" alt=\"Mocks Server logo\"></a></p>\n\n<p align=\"center\">\n  <a href=\"https://github.com/mocks-server/main/actions?query=workflow%3Abuild+branch%3Amaster\"><img src=\"https://github.com/mocks-server/main/workflows/build/badge.svg?branch=master\" alt=\"Build Status\"></a>\n  <a href=\"https://codecov.io/gh/mocks-server/main\"><img src=\"https://codecov.io/gh/mocks-server/main/branch/master/graph/badge.svg?token=2S8ZR55AJV\" alt=\"Coverage\"></a>\n  <a href=\"https://sonarcloud.io/project/overview?id=mocks-server_main_cypress-commands\"><img src=\"https://sonarcloud.io/api/project_badges/measure?project=mocks-server_main_cypress-commands&metric=alert_status\" alt=\"Quality Gate\"></a>\n  <a href=\"https://www.npmjs.com/package/@mocks-server/cypress-commands\"><img src=\"https://img.shields.io/npm/dm/@mocks-server/cypress-commands.svg\" alt=\"Downloads\"></a>\n  <a href=\"https://renovatebot.com\"><img src=\"https://img.shields.io/badge/renovate-enabled-brightgreen.svg\" alt=\"Renovate\"></a>\n  <a href=\"https://github.com/mocks-server/main/blob/master/packages/cypress-commands/LICENSE\"><img src=\"https://img.shields.io/npm/l/@mocks-server/cypress-commands.svg\" alt=\"License\"></a>\n</p>\n\n---\n\n# Mocks Server Cypress commands\n\nExtends Cypress' cy commands with methods for easily changing [Mocks Server configuration][mocks-server-options-url] while it is running, such as current collection, custom route variants, delay time, etc.\n\nFor further info, you can read the [Mocks Server Cypress integration docs](https://www.mocks-server.org/docs/integrations/cypress).\n\n## Installation\n\nThis module is distributed via npm and should be installed as one of your project's devDependencies:\n\n```bash\nnpm i --save-dev @mocks-server/cypress-commands\n```\n\n### Registering commands\n\n`@mocks-server/cypress-commands` extends Cypress' cy commands.\n\nAt the top of your Cypress' support file (usually `cypress/support/e2e.js` for `e2e` testing type):\n\n```javascript\nimport { register } from \"@mocks-server/cypress-commands\";\n\nregister();\n```\n\nRead [Cypress configuration docs](https://docs.cypress.io/guides/references/configuration) for further info.\n\n<details>\n<summary><strong>Registering commands in Cypress <10.0</strong></summary>\n\nAdd these lines to your project's `cypress/support/index.js`:\n\n```js\nimport { register } from \"@mocks-server/cypress-commands\";\n\nregister();\n```\n\n</details>\n\n## Usage\n\nOnce registered, you can use all next commands:\n\n### Commands\n\n#### `cy.mocksSetCollection(\"users-error\")`\n\nSet current collection.\n\n#### `cy.mocksUseRouteVariant(\"users:success\")`\n\nSet a specific route variant to be used by the current collection.\n\n#### `cy.mocksRestoreRouteVariants()`\n\nRestore route variants to those defined in the current collection.\n\n#### `cy.mocksSetDelay(2000)`\n\nSet routes default delay.\n\n#### `cy.mocksSetConfig({ files: { watch: false}, mock: { routes: { delay: 0 }}})`\n\nSet any [Mocks Server setting][mocks-server-options-url].\n\n#### `cy.mocksConfigClient(configuration)`\n\nConfigures the [Mocks Server administration API client](https://github.com/mocks-server/admin-api-client), used under the hood to communicate with the administration REST API.\n\n* __`configuration`__ _`<Object>`_ - It must be an object containing any of next properties:\n  * __`enabled`__ _`<Boolean>`_ - Enables or disables the API client.\n  * __`port`__ _`<Number>`_ - Changes the API client port. \n  * __`host`__ _`<String>`_ - Changes the API client host.\n  * __`https`__ _`<Boolean>`_ - If `true`, changes the client protocol to \"https\". Default is `false`.\n\n## Configuration\n\nBy default, the API client is configured to request to `http://127.0.0.1:3110/api`, based in the [default Mocks Server Plugin Admin Api options][mocks-server-options-url]\n\nUse next settings only if you changed the administration API configuration and you need to configure the client properly, or in case you also need to run your tests without starting the Mocks Server.\n\nYou can change the protocol, host and port of the administration API using the `cy.mocksConfigClient` command mentioned above, or the plugin environment variables:\n\n* __`MOCKS_SERVER_LOGS`__: Log commands status on Cypress or not. Default is `true`.\n* __`MOCKS_SERVER_ADMIN_API_PORT`__: Modifies the admin API client port. Default is `3110`.\n* __`MOCKS_SERVER_ADMIN_API_HOST`__: Modifies the admin API client host. Default is `127.0.0.1`.\n* __`MOCKS_SERVER_ADMIN_API_HTTPS`__: If `true`, changes the admin API client protocol to \"https\". Default is `false`.\n* __`MOCKS_SERVER_ENABLED`__: Disables requests to the Mocks Server admin API, so the commands will not fail even when Mocks Server is not running. This is useful to reuse same tests with a mocked API and a real API, because commands to change Mocks Server configuration will be ignored.\n\n> Note: These environment variables only affect to the default Mocks Server API client (except `MOCKS_SERVER_LOGS`). Read [usage with multiple Mocks Servers](#usage-with-multiple-mocks-servers) bellow for further info.\n\n### Using commands\n\nYou should usually change Mocks Server configuration in a `before` statement:\n\n```js\ndescribe(\"user with default role\", () => {\n  before(() => {\n    cy.mocksSetCollection(\"normal-user\");\n    cy.visit(\"/\");\n  });\n\n  it(\"should not see the users section link\", () => {\n    cy.get(\"#users-section-link\").should(\"not.be.visible\");\n  });\n});\n\ndescribe(\"user with admin role\", () => {\n  before(() => {\n    cy.mocksSetCollection(\"admin-user\");\n    cy.visit(\"/\");\n  });\n\n  it(\"should see the users section link\", () => {\n    cy.get(\"#users-section-link\").should(\"be.visible\");\n  });\n});\n```\n\n## Usage with multiple Mocks Servers\n\nThis package can be used also to control multiple Mocks Server processes. __All commands described above support passing an extra argument__, which can be a different `AdminApiClient` instance configured in a different way. When the commands receive a `AdminApiClient` instance, it uses its configuration to perform requests to the Mocks Server administration API client instead of the default one.\n\nNote that changing the plugin environment variables values don't affect to custom API clients created this way, so, if you want to configure them using environment variables you'll have to use your own.\n\n### AdminApiClient(configuration)\n\nReturns a new Mocks Server Admin API client to be provided to this plugin's Cypress commands, so they use that client instead of the default one. Configuration options are the same than described for the `cy.mocksConfigClient` command:\n\n* __`configuration`__ _`<Object>`_ - Optional (configuration can be changed also afterwards using the `cy.mocksConfigClient` command and passing the client to be configured). It should be an object containing any of next properties:\n  * __`enabled`__ _`<Boolean>`_ - Enables or disables the API client.\n  * __`port`__ _`<Number>`_ - Changes the API client port. \n  * __`host`__ _`<String>`_ - Changes the API client host.\n  * __`https`__ _`<Boolean>`_ - If `true`, changes the client protocol to \"https\". Default is `false`.\n\n### Commands API when using a custom client\n\n* __`cy.mocksSetCollection(\"users-error\", adminApiClient)`__ - Set current collection using the provided client.\n* __`cy.mocksUseRouteVariant(\"users:success\", adminApiClient)`__ - Set a specific route variant using the provided client.\n* __`cy.mocksRestoreRouteVariants(adminApiClient)`__ - Restore route variants using the provided client.\n* __`cy.mocksSetDelay(2000, adminApiClient)`__ - Set routes default delay using the provided client.\n* __`cy.mocksSetConfig(mocksServerConfiguration, adminApiClient)`__ - Set any [Mocks Server setting][mocks-server-options-url] using the provided client.\n* __`cy.mocksConfigClient(clientConfiguration, adminApiClient)`__ - Configures the provided admin API client.\n\n### Example\n\n```js\nimport { AdminApiClient } from \"@mocks-server/cypress-commands\";\n\nconst usersApiClient = new AdminApiClient({\n  port: 3500,\n  host: \"127.0.0.1\"\n});\nconst gravatarApiClient = new AdminApiClient({\n  port: 3200,\n  host: \"localhost\"\n});\n\ndescribe(\"users page\", () => {\n  describe(\"When normal user is logged in and gravatar API does not work\", () => {\n    before(() => {\n      cy.mocksSetCollection(\"normal-user\", usersApiClient);\n      cy.mocksSetCollection(\"server-error\", gravatarApiClient);\n      cy.visit(\"/\");\n    });\n\n    it(\"should not see the users section link\", () => {\n      cy.get(\"#users-section-link\").should(\"not.be.visible\");\n    });\n\n    it(\"should not display user avatars\", () => {\n      cy.get(\".user-avatar\").should(\"not.be.visible\");\n    });\n  });\n});\n```\n\n## Usage with TypeScript\n\nFor those writing [TypesScript tests in Cypress][cypress-typescript], this package includes TypeScript declarations.\n\nAdd \"@mocks-server/cypress-commands\" to the `types` property in the `tsconfig.json` file. You may also need to set the TS `allowSyntheticDefaultImports` option to true:\n\n```json\n{\n  \"compilerOptions\": {\n    \"types\": [\"cypress\", \"@mocks-server/cypress-commands\"],\n    \"allowSyntheticDefaultImports\": true\n  }\n}\n```\n\nOr reference the package in the files using it:\n\n```typescript\n/// <reference types=\"@mocks-server/cypress-commands\" />\n```\n\n## Further info\n\nFor further info, you can read the [Mocks Server Cypress integration docs](https://www.mocks-server.org/docs/integrations/cypress).\n\n## Release notes\n\nCurrent major release (`5.x`) is compatible only with `@mocks-server/main` versions upper or equal than `3.6`. Use prior releases for lower versions. If you don't want to update to the latest major version of this package yet but you want to update `@mocks-server/main`, you can also use any `4.x` version of this package with any `@mocks-server/main@3.x` version.\n\n## License\n\nMIT, see [LICENSE](./LICENSE) for details.\n\n[mocks-server-url]: https://www.mocks-server.org\n[mocks-server-options-url]: https://www.mocks-server.org/docs/configuration/options\n[cypress-typescript]: https://docs.cypress.io/guides/tooling/typescript-support.html\n"
}